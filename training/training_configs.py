# training_configs.py
IMG_SIZE = (1280, 1280)
NUM_CLASSES = 1
EPOCHS = 1000
PATIENCE = 50
LEARNING_RATE = 0.001
ACCUMULATION_STEPS = 4

BATCH_SIZE_SMALL = 4
BATCH_SIZE_MEDIUM = 2
BATCH_SIZE_LARGE = 1
BATCH_SIZE_HUGE = 2

BATCH_SIZE_MIN = 1
BATCH_SIZE_MAX = 128
BATCH_SIZE_NB_TESTS = 2

CONFIGS = {
    "unet_efficientnet_b3_imagenet": {
        "architecture": "unet",
        "backbone": "timm-efficientnet-b3",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unet_efficientvit_b2_imagenet": {
        "architecture": "unet",
        "backbone": "tu-efficientvit_b2.r224_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unet_fastvit_t8_imagenet": {
        "architecture": "unet",
        "backbone": "tu-fastvit_t8.apple_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unet_repvit_m1_imagenet": {
        "architecture": "unet",
        "backbone": "tu-repvit_m1.dist_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },
    
    "unet_regnety_032_imagenet": {
        "architecture": "unet",
        "backbone": "tu-regnety_032.ra_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unet_mambaout_small_imagenet": {
        "architecture": "unet",
        "backbone": "tu-mambaout_small",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },
    
    "unet_efficientnetv2_s_imagenet": {
        "architecture": "unet",
        "backbone": "tu-efficientnetv2_rw_s.ra2_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unet_regnety_080_imagenet": {
        "architecture": "unet",
        "backbone": "tu-regnety_080.ra3_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unet_res2net101_26w_4s_imagenet": {
        "architecture": "unet",
        "backbone": "timm-res2net101_26w_4s",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unet_resnext50_32x4d_imagenet": {
        "architecture": "unet",
        "backbone": "resnext50_32x4d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unet_mambaout_base_imagenet": {
        "architecture": "unet",
        "backbone": "tu-mambaout_base",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },
    
    "unet_efficientnetv2_m_imagenet": {
        "architecture": "unet",
        "backbone": "tu-efficientnetv2_rw_m.agc_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unet_resnest200e_imagenet": {
        "architecture": "unet",
        "backbone": "timm-resnest200e",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unet_resnext101_32x8d_imagenet": {
        "architecture": "unet",
        "backbone": "resnext101_32x8d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unet_timm_efficientnet_b5_imagenet": {
        "architecture": "unet",
        "backbone": "timm-efficientnet-b5",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unet_efficientnetv2_xl_imagenet": {
        "architecture": "unet",
        "backbone": "tu-tf_efficientnetv2_xl.in21k_ft_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_HUGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },
    
    "unetplusplus_efficientnet_b3_imagenet": {
        "architecture": "unetplusplus",
        "backbone": "timm-efficientnet-b3",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unetplusplus_efficientvit_b2_imagenet": {
        "architecture": "unetplusplus",
        "backbone": "tu-efficientvit_b2.r224_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unetplusplus_fastvit_t8_imagenet": {
        "architecture": "unetplusplus",
        "backbone": "tu-fastvit_t8.apple_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unetplusplus_repvit_m1_imagenet": {
        "architecture": "unetplusplus",
        "backbone": "tu-repvit_m1.dist_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unetplusplus_regnety_032_imagenet": {
        "architecture": "unetplusplus",
        "backbone": "tu-regnety_032.ra_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unetplusplus_mambaout_small_imagenet": {
        "architecture": "unetplusplus",
        "backbone": "tu-mambaout_small",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unetplusplus_efficientnetv2_s_imagenet": {
        "architecture": "unetplusplus",
        "backbone": "tu-efficientnetv2_rw_s.ra2_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unetplusplus_regnety_080_imagenet": {
        "architecture": "unetplusplus",
        "backbone": "tu-regnety_080.ra3_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unetplusplus_res2net101_26w_4s_imagenet": {
        "architecture": "unetplusplus",
        "backbone": "timm-res2net101_26w_4s",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unetplusplus_resnext50_32x4d_imagenet": {
        "architecture": "unetplusplus",
        "backbone": "resnext50_32x4d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unetplusplus_mambaout_base_imagenet": {
        "architecture": "unetplusplus",
        "backbone": "tu-mambaout_base",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unetplusplus_efficientnetv2_m_imagenet": {
        "architecture": "unetplusplus",
        "backbone": "tu-efficientnetv2_rw_m.agc_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unetplusplus_resnest200e_imagenet": {
        "architecture": "unetplusplus",
        "backbone": "timm-resnest200e",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unetplusplus_resnext101_32x8d_imagenet": {
        "architecture": "unetplusplus",
        "backbone": "resnext101_32x8d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unetplusplus_timm_efficientnet_b5_imagenet": {
        "architecture": "unetplusplus",
        "backbone": "timm-efficientnet-b5",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "unetplusplus_efficientnetv2_xl_imagenet": {
        "architecture": "unetplusplus",
        "backbone": "tu-tf_efficientnetv2_xl.in21k_ft_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_HUGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "manet_efficientnet_b3_imagenet": {
        "architecture": "manet",
        "backbone": "timm-efficientnet-b3",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "manet_efficientvit_b2_imagenet": {
        "architecture": "manet",
        "backbone": "tu-efficientvit_b2.r224_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "manet_fastvit_t8_imagenet": {
        "architecture": "manet",
        "backbone": "tu-fastvit_t8.apple_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "manet_repvit_m1_imagenet": {
        "architecture": "manet",
        "backbone": "tu-repvit_m1.dist_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "manet_regnety_032_imagenet": {
        "architecture": "manet",
        "backbone": "tu-regnety_032.ra_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "manet_mambaout_small_imagenet": {
        "architecture": "manet",
        "backbone": "tu-mambaout_small",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "manet_efficientnetv2_s_imagenet": {
        "architecture": "manet",
        "backbone": "tu-efficientnetv2_rw_s.ra2_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "manet_regnety_080_imagenet": {
        "architecture": "manet",
        "backbone": "tu-regnety_080.ra3_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "manet_res2net101_26w_4s_imagenet": {
        "architecture": "manet",
        "backbone": "timm-res2net101_26w_4s",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "manet_resnext50_32x4d_imagenet": {
        "architecture": "manet",
        "backbone": "resnext50_32x4d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "manet_mambaout_base_imagenet": {
        "architecture": "manet",
        "backbone": "tu-mambaout_base",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "manet_efficientnetv2_m_imagenet": {
        "architecture": "manet",
        "backbone": "tu-efficientnetv2_rw_m.agc_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "manet_resnest200e_imagenet": {
        "architecture": "manet",
        "backbone": "timm-resnest200e",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "manet_resnext101_32x8d_imagenet": {
        "architecture": "manet",
        "backbone": "resnext101_32x8d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "manet_timm_efficientnet_b5_imagenet": {
        "architecture": "manet",
        "backbone": "timm-efficientnet-b5",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "manet_efficientnetv2_xl_imagenet": {
        "architecture": "manet",
        "backbone": "tu-tf_efficientnetv2_xl.in21k_ft_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_HUGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "linknet_efficientnet_b3_imagenet": {
        "architecture": "linknet",
        "backbone": "timm-efficientnet-b3",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "linknet_efficientvit_b2_imagenet": {
        "architecture": "linknet",
        "backbone": "tu-efficientvit_b2.r224_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "linknet_fastvit_t8_imagenet": {
        "architecture": "linknet",
        "backbone": "tu-fastvit_t8.apple_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "linknet_repvit_m1_imagenet": {
        "architecture": "linknet",
        "backbone": "tu-repvit_m1.dist_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "linknet_regnety_032_imagenet": {
        "architecture": "linknet",
        "backbone": "tu-regnety_032.ra_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "linknet_mambaout_small_imagenet": {
        "architecture": "linknet",
        "backbone": "tu-mambaout_small",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "linknet_efficientnetv2_s_imagenet": {
        "architecture": "linknet",
        "backbone": "tu-efficientnetv2_rw_s.ra2_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "linknet_regnety_080_imagenet": {
        "architecture": "linknet",
        "backbone": "tu-regnety_080.ra3_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "linknet_res2net101_26w_4s_imagenet": {
        "architecture": "linknet",
        "backbone": "timm-res2net101_26w_4s",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "linknet_resnext50_32x4d_imagenet": {
        "architecture": "linknet",
        "backbone": "resnext50_32x4d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "linknet_mambaout_base_imagenet": {
        "architecture": "linknet",
        "backbone": "tu-mambaout_base",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "linknet_efficientnetv2_m_imagenet": {
        "architecture": "linknet",
        "backbone": "tu-efficientnetv2_rw_m.agc_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "linknet_resnest200e_imagenet": {
        "architecture": "linknet",
        "backbone": "timm-resnest200e",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "linknet_resnext101_32x8d_imagenet": {
        "architecture": "linknet",
        "backbone": "resnext101_32x8d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "linknet_timm_efficientnet_b5_imagenet": {
        "architecture": "linknet",
        "backbone": "timm-efficientnet-b5",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "linknet_efficientnetv2_xl_imagenet": {
        "architecture": "linknet",
        "backbone": "tu-tf_efficientnetv2_xl.in21k_ft_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_HUGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "fpn_efficientnet_b3_imagenet": {
        "architecture": "fpn",
        "backbone": "timm-efficientnet-b3",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "fpn_efficientvit_b2_imagenet": {
        "architecture": "fpn",
        "backbone": "tu-efficientvit_b2.r224_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "fpn_fastvit_t8_imagenet": {
        "architecture": "fpn",
        "backbone": "tu-fastvit_t8.apple_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "fpn_repvit_m1_imagenet": {
        "architecture": "fpn",
        "backbone": "tu-repvit_m1.dist_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "fpn_regnety_032_imagenet": {
        "architecture": "fpn",
        "backbone": "tu-regnety_032.ra_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "fpn_mambaout_small_imagenet": {
        "architecture": "fpn",
        "backbone": "tu-mambaout_small",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "fpn_efficientnetv2_s_imagenet": {
        "architecture": "fpn",
        "backbone": "tu-efficientnetv2_rw_s.ra2_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "fpn_regnety_080_imagenet": {
        "architecture": "fpn",
        "backbone": "tu-regnety_080.ra3_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "fpn_res2net101_26w_4s_imagenet": {
        "architecture": "fpn",
        "backbone": "timm-res2net101_26w_4s",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "fpn_resnext50_32x4d_imagenet": {
        "architecture": "fpn",
        "backbone": "resnext50_32x4d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "fpn_mambaout_base_imagenet": {
        "architecture": "fpn",
        "backbone": "tu-mambaout_base",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "fpn_efficientnetv2_m_imagenet": {
        "architecture": "fpn",
        "backbone": "tu-efficientnetv2_rw_m.agc_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "fpn_resnest200e_imagenet": {
        "architecture": "fpn",
        "backbone": "timm-resnest200e",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "fpn_resnext101_32x8d_imagenet": {
        "architecture": "fpn",
        "backbone": "resnext101_32x8d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "fpn_timm_efficientnet_b5_imagenet": {
        "architecture": "fpn",
        "backbone": "timm-efficientnet-b5",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "fpn_efficientnetv2_xl_imagenet": {
        "architecture": "fpn",
        "backbone": "tu-tf_efficientnetv2_xl.in21k_ft_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_HUGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pan_efficientnet_b3_imagenet": {
        "architecture": "pan",
        "backbone": "timm-efficientnet-b3",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pan_efficientvit_b2_imagenet": {
        "architecture": "pan",
        "backbone": "tu-efficientvit_b2.r224_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pan_fastvit_t8_imagenet": {
        "architecture": "pan",
        "backbone": "tu-fastvit_t8.apple_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pan_repvit_m1_imagenet": {
        "architecture": "pan",
        "backbone": "tu-repvit_m1.dist_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pan_regnety_032_imagenet": {
        "architecture": "pan",
        "backbone": "tu-regnety_032.ra_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pan_mambaout_small_imagenet": {
        "architecture": "pan",
        "backbone": "tu-mambaout_small",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pan_efficientnetv2_s_imagenet": {
        "architecture": "pan",
        "backbone": "tu-efficientnetv2_rw_s.ra2_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pan_regnety_080_imagenet": {
        "architecture": "pan",
        "backbone": "tu-regnety_080.ra3_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pan_res2net101_26w_4s_imagenet": {
        "architecture": "pan",
        "backbone": "timm-res2net101_26w_4s",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pan_resnext50_32x4d_imagenet": {
        "architecture": "pan",
        "backbone": "resnext50_32x4d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pan_mambaout_base_imagenet": {
        "architecture": "pan",
        "backbone": "tu-mambaout_base",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pan_efficientnetv2_m_imagenet": {
        "architecture": "pan",
        "backbone": "tu-efficientnetv2_rw_m.agc_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pan_resnest200e_imagenet": {
        "architecture": "pan",
        "backbone": "timm-resnest200e",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pan_resnext101_32x8d_imagenet": {
        "architecture": "pan",
        "backbone": "resnext101_32x8d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pan_timm_efficientnet_b5_imagenet": {
        "architecture": "pan",
        "backbone": "timm-efficientnet-b5",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pan_efficientnetv2_xl_imagenet": {
        "architecture": "pan",
        "backbone": "tu-tf_efficientnetv2_xl.in21k_ft_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_HUGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pspnet_efficientnet_b3_imagenet": {
        "architecture": "pspnet",
        "backbone": "timm-efficientnet-b3",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pspnet_efficientvit_b2_imagenet": {
        "architecture": "pspnet",
        "backbone": "tu-efficientvit_b2.r224_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pspnet_fastvit_t8_imagenet": {
        "architecture": "pspnet",
        "backbone": "tu-fastvit_t8.apple_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pspnet_repvit_m1_imagenet": {
        "architecture": "pspnet",
        "backbone": "tu-repvit_m1.dist_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pspnet_regnety_032_imagenet": {
        "architecture": "pspnet",
        "backbone": "tu-regnety_032.ra_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pspnet_mambaout_small_imagenet": {
        "architecture": "pspnet",
        "backbone": "tu-mambaout_small",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pspnet_efficientnetv2_s_imagenet": {
        "architecture": "pspnet",
        "backbone": "tu-efficientnetv2_rw_s.ra2_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pspnet_regnety_080_imagenet": {
        "architecture": "pspnet",
        "backbone": "tu-regnety_080.ra3_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pspnet_res2net101_26w_4s_imagenet": {
        "architecture": "pspnet",
        "backbone": "timm-res2net101_26w_4s",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pspnet_resnext50_32x4d_imagenet": {
        "architecture": "pspnet",
        "backbone": "resnext50_32x4d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pspnet_mambaout_base_imagenet": {
        "architecture": "pspnet",
        "backbone": "tu-mambaout_base",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pspnet_efficientnetv2_m_imagenet": {
        "architecture": "pspnet",
        "backbone": "tu-efficientnetv2_rw_m.agc_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pspnet_resnest200e_imagenet": {
        "architecture": "pspnet",
        "backbone": "timm-resnest200e",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pspnet_resnext101_32x8d_imagenet": {
        "architecture": "pspnet",
        "backbone": "resnext101_32x8d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pspnet_timm_efficientnet_b5_imagenet": {
        "architecture": "pspnet",
        "backbone": "timm-efficientnet-b5",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "pspnet_efficientnetv2_xl_imagenet": {
        "architecture": "pspnet",
        "backbone": "tu-tf_efficientnetv2_xl.in21k_ft_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_HUGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "segformer_efficientnet_b3_imagenet": {
        "architecture": "segformer",
        "backbone": "timm-efficientnet-b3",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "segformer_efficientvit_b2_imagenet": {
        "architecture": "segformer",
        "backbone": "tu-efficientvit_b2.r224_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "segformer_fastvit_t8_imagenet": {
        "architecture": "segformer",
        "backbone": "tu-fastvit_t8.apple_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "segformer_repvit_m1_imagenet": {
        "architecture": "segformer",
        "backbone": "tu-repvit_m1.dist_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "segformer_regnety_032_imagenet": {
        "architecture": "segformer",
        "backbone": "tu-regnety_032.ra_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "segformer_mambaout_small_imagenet": {
        "architecture": "segformer",
        "backbone": "tu-mambaout_small",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "segformer_efficientnetv2_s_imagenet": {
        "architecture": "segformer",
        "backbone": "tu-efficientnetv2_rw_s.ra2_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "segformer_regnety_080_imagenet": {
        "architecture": "segformer",
        "backbone": "tu-regnety_080.ra3_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "segformer_res2net101_26w_4s_imagenet": {
        "architecture": "segformer",
        "backbone": "timm-res2net101_26w_4s",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "segformer_resnext50_32x4d_imagenet": {
        "architecture": "segformer",
        "backbone": "resnext50_32x4d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "segformer_mambaout_base_imagenet": {
        "architecture": "segformer",
        "backbone": "tu-mambaout_base",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "segformer_efficientnetv2_m_imagenet": {
        "architecture": "segformer",
        "backbone": "tu-efficientnetv2_rw_m.agc_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "segformer_resnest200e_imagenet": {
        "architecture": "segformer",
        "backbone": "timm-resnest200e",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "segformer_resnext101_32x8d_imagenet": {
        "architecture": "segformer",
        "backbone": "resnext101_32x8d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "segformer_timm_efficientnet_b5_imagenet": {
        "architecture": "segformer",
        "backbone": "timm-efficientnet-b5",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "segformer_efficientnetv2_xl_imagenet": {
        "architecture": "segformer",
        "backbone": "tu-tf_efficientnetv2_xl.in21k_ft_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_HUGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "deeplabv3_efficientnet_b3_imagenet": {
        "architecture": "deeplabv3",
        "backbone": "timm-efficientnet-b3",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": max(int(BATCH_SIZE_SMALL/2), 1),
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "deeplabv3_efficientvit_b2_imagenet": {
        "architecture": "deeplabv3",
        "backbone": "tu-efficientvit_b2.r224_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": max(int(BATCH_SIZE_SMALL/2), 1),
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "deeplabv3_fastvit_t8_imagenet": {
        "architecture": "deeplabv3",
        "backbone": "tu-fastvit_t8.apple_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS/2),
        "auto_batch_size": False,
        "batch_size": max(int(BATCH_SIZE_SMALL/2), 1),
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "deeplabv3_repvit_m1_imagenet": {
        "architecture": "deeplabv3",
        "backbone": "tu-repvit_m1.dist_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS/2),
        "auto_batch_size": False,
        "batch_size": max(int(BATCH_SIZE_SMALL/2), 1),
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "deeplabv3_regnety_032_imagenet": {
        "architecture": "deeplabv3",
        "backbone": "tu-regnety_032.ra_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS/2),
        "auto_batch_size": False,
        "batch_size": max(int(BATCH_SIZE_SMALL/2), 1),
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "deeplabv3_mambaout_small_imagenet": {
        "architecture": "deeplabv3",
        "backbone": "tu-mambaout_small",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS/2),
        "auto_batch_size": False,
        "batch_size": max(int(BATCH_SIZE_MEDIUM/2), 1),
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "deeplabv3_efficientnetv2_s_imagenet": {
        "architecture": "deeplabv3",
        "backbone": "tu-efficientnetv2_rw_s.ra2_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS/2),
        "auto_batch_size": False,
        "batch_size": max(int(BATCH_SIZE_MEDIUM/2), 1),
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "deeplabv3_regnety_080_imagenet": {
        "architecture": "deeplabv3",
        "backbone": "tu-regnety_080.ra3_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS/2),
        "auto_batch_size": False,
        "batch_size": max(int(BATCH_SIZE_MEDIUM/2), 1),
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "deeplabv3_res2net101_26w_4s_imagenet": {
        "architecture": "deeplabv3",
        "backbone": "timm-res2net101_26w_4s",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS/2),
        "auto_batch_size": False,
        "batch_size": max(int(BATCH_SIZE_MEDIUM/2), 1),
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "deeplabv3_resnext50_32x4d_imagenet": {
        "architecture": "deeplabv3",
        "backbone": "resnext50_32x4d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS/2),
        "auto_batch_size": False,
        "batch_size": max(int(BATCH_SIZE_MEDIUM/2), 1),
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "deeplabv3_mambaout_base_imagenet": {
        "architecture": "deeplabv3",
        "backbone": "tu-mambaout_base",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS/2),
        "auto_batch_size": False,
        "batch_size": max(int(BATCH_SIZE_MEDIUM/2), 1),
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "deeplabv3_efficientnetv2_m_imagenet": {
        "architecture": "deeplabv3",
        "backbone": "tu-efficientnetv2_rw_m.agc_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS/2),
        "auto_batch_size": False,
        "batch_size": max(int(BATCH_SIZE_LARGE/2), 1),
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "deeplabv3_resnest200e_imagenet": {
        "architecture": "deeplabv3",
        "backbone": "timm-resnest200e",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS/2),
        "auto_batch_size": False,
        "batch_size": max(int(BATCH_SIZE_LARGE/2), 1),
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "deeplabv3_resnext101_32x8d_imagenet": {
        "architecture": "deeplabv3",
        "backbone": "resnext101_32x8d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS/2),
        "auto_batch_size": False,
        "batch_size": max(int(BATCH_SIZE_LARGE/2), 1),
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "deeplabv3_timm_efficientnet_b5_imagenet": {
        "architecture": "deeplabv3",
        "backbone": "timm-efficientnet-b5",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS/2),
        "auto_batch_size": False,
        "batch_size": max(int(BATCH_SIZE_LARGE/2), 1),
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "deeplabv3_efficientnetv2_xl_imagenet": {
        "architecture": "deeplabv3",
        "backbone": "tu-tf_efficientnetv2_xl.in21k_ft_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": max(int(BATCH_SIZE_HUGE/2), 1),
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    # DPT models

    "dpt_efficientnet_b3_imagenet": {
        "architecture": "dpt",
        "backbone": "timm-efficientnet-b3",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "dpt_efficientvit_b2_imagenet": {
        "architecture": "dpt",
        "backbone": "tu-efficientvit_b2.r224_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "dpt_fastvit_t8_imagenet": {
        "architecture": "dpt",
        "backbone": "tu-fastvit_t8.apple_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "dpt_repvit_m1_imagenet": {
        "architecture": "dpt",
        "backbone": "tu-repvit_m1.dist_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "dpt_regnety_032_imagenet": {
        "architecture": "dpt",
        "backbone": "tu-regnety_032.ra_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "dpt_mambaout_small_imagenet": {
        "architecture": "dpt",
        "backbone": "tu-mambaout_small",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "dpt_efficientnetv2_s_imagenet": {
        "architecture": "dpt",
        "backbone": "tu-efficientnetv2_rw_s.ra2_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "dpt_regnety_080_imagenet": {
        "architecture": "dpt",
        "backbone": "tu-regnety_080.ra3_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "dpt_res2net101_26w_4s_imagenet": {
        "architecture": "dpt",
        "backbone": "timm-res2net101_26w_4s",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "dpt_resnext50_32x4d_imagenet": {
        "architecture": "dpt",
        "backbone": "resnext50_32x4d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "dpt_mambaout_base_imagenet": {
        "architecture": "dpt",
        "backbone": "tu-mambaout_base",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "dpt_efficientnetv2_m_imagenet": {
        "architecture": "dpt",
        "backbone": "tu-efficientnetv2_rw_m.agc_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "dpt_resnest200e_imagenet": {
        "architecture": "dpt",
        "backbone": "timm-resnest200e",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "dpt_resnext101_32x8d_imagenet": {
        "architecture": "dpt",
        "backbone": "resnext101_32x8d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "dpt_timm_efficientnet_b5_imagenet": {
        "architecture": "dpt",
        "backbone": "timm-efficientnet-b5",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "dpt_efficientnetv2_xl_imagenet": {
        "architecture": "dpt",
        "backbone": "tu-tf_efficientnetv2_xl.in21k_ft_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_HUGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "upernet_efficientnet_b3_imagenet": {
        "architecture": "upernet",
        "backbone": "timm-efficientnet-b3",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "upernet_efficientvit_b2_imagenet": {
        "architecture": "upernet",
        "backbone": "tu-efficientvit_b2.r224_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "upernet_fastvit_t8_imagenet": {
        "architecture": "upernet",
        "backbone": "tu-fastvit_t8.apple_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "upernet_repvit_m1_imagenet": {
        "architecture": "upernet",
        "backbone": "tu-repvit_m1.dist_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "upernet_regnety_032_imagenet": {
        "architecture": "upernet",
        "backbone": "tu-regnety_032.ra_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_SMALL,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "upernet_mambaout_small_imagenet": {
        "architecture": "upernet",
        "backbone": "tu-mambaout_small",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "upernet_efficientnetv2_s_imagenet": {
        "architecture": "upernet",
        "backbone": "tu-efficientnetv2_rw_s.ra2_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "upernet_regnety_080_imagenet": {
        "architecture": "upernet",
        "backbone": "tu-regnety_080.ra3_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "upernet_res2net101_26w_4s_imagenet": {
        "architecture": "upernet",
        "backbone": "timm-res2net101_26w_4s",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "upernet_resnext50_32x4d_imagenet": {
        "architecture": "upernet",
        "backbone": "resnext50_32x4d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_MEDIUM,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "upernet_mambaout_base_imagenet": {
        "architecture": "upernet",
        "backbone": "tu-mambaout_base",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE/10,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "upernet_efficientnetv2_m_imagenet": {
        "architecture": "upernet",
        "backbone": "tu-efficientnetv2_rw_m.agc_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "upernet_resnest200e_imagenet": {
        "architecture": "upernet",
        "backbone": "timm-resnest200e",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS*2,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "upernet_resnext101_32x8d_imagenet": {
        "architecture": "upernet",
        "backbone": "resnext101_32x8d",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "upernet_timm_efficientnet_b5_imagenet": {
        "architecture": "upernet",
        "backbone": "timm-efficientnet-b5",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": ACCUMULATION_STEPS,
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_LARGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

    "upernet_efficientnetv2_xl_imagenet": {
        "architecture": "upernet",
        "backbone": "tu-tf_efficientnetv2_xl.in21k_ft_in1k",
        "encoder_weights": "imagenet",
        "img_size": IMG_SIZE,
        "num_classes": NUM_CLASSES,
        "learning_rate": LEARNING_RATE,
        "epochs": EPOCHS,
        "patience": PATIENCE,
        "accumulation_steps": int(ACCUMULATION_STEPS / 4),
        "auto_batch_size": False,
        "batch_size": BATCH_SIZE_HUGE,
        "min_batch_size_search": BATCH_SIZE_MIN,
        "max_batch_size_search": BATCH_SIZE_MAX,
        "batch_size_test_steps": BATCH_SIZE_NB_TESTS,
    },

}

